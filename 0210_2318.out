2022-02-10 10:17:23,960 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.12 |Anaconda, Inc.| (default, Sep  8 2020, 23:10:56) [GCC 7.3.0]
CUDA available: True
GPU 0,1,2,3: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-11.1
NVCC: Build cuda_11.1.TC455_06.29069683_0
GCC: gcc (Ubuntu 7.5.0-6ubuntu2) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.1
OpenCV: 4.4.0
MMCV: 1.2.4
MMCV Compiler: GCC 7.5
MMCV CUDA Compiler: 11.1
MMDetection: 2.7.0+unknown
------------------------------------------------------------

2022-02-10 10:17:25,361 - mmdet - INFO - Distributed training: True
2022-02-10 10:17:26,896 - mmdet - INFO - Config:
dataset_type = 'CocoDataset'
data_root = '/data2/zpf/mmd_xsf/data/xsf_0/'
img_norm_cfg = dict(
    mean=[102.9801, 115.9465, 122.7717], std=[1, 1, 1], to_rgb=False)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(type='Resize', img_scale=(512, 512), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[102.9801, 115.9465, 122.7717],
        std=[1, 1, 1],
        to_rgb=False),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(512, 512),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[102.9801, 115.9465, 122.7717],
                std=[1, 1, 1],
                to_rgb=False),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/data2/zpf/mmd_xsf/data/xsf_0/annotations/instances_train2017.json',
        img_prefix='/data2/zpf/mmd_xsf/data/xsf_0/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(type='Resize', img_scale=(512, 512), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[102.9801, 115.9465, 122.7717],
                std=[1, 1, 1],
                to_rgb=False),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/data2/zpf/mmd_xsf/data/xsf_0/annotations/instances_val2017.json',
        img_prefix='/data2/zpf/mmd_xsf/data/xsf_0/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(512, 512),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[102.9801, 115.9465, 122.7717],
                        std=[1, 1, 1],
                        to_rgb=False),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/data2/zpf/mmd_xsf/data/xsf_0/annotations/instances_val2017.json',
        img_prefix='/data2/zpf/mmd_xsf/data/xsf_0/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(512, 512),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[102.9801, 115.9465, 122.7717],
                        std=[1, 1, 1],
                        to_rgb=False),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
model = dict(
    type='FCOS',
    pretrained='open-mmlab://detectron2/resnet101_caffe',
    backbone=dict(
        type='ResNet',
        depth=101,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=False),
        norm_eval=True,
        dcn=dict(
            type='DyXConv',
            K_convs=4,
            ratios=0.25,
            temperature=34,
            deform_groups=4,
            mode='sigmoid',
            dy_deform_w=True,
            dcn=dict(type='DCNv2')),
        stage_with_dcn=(False, False, False, True),
        style='caffe'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=1,
        add_extra_convs=True,
        extra_convs_on_inputs=False,
        num_outs=5,
        relu_before_extra_convs=True),
    bbox_head=dict(
        type='FCOSHead_RCNN',
        num_classes=491,
        in_channels=256,
        stacked_convs=4,
        feat_channels=256,
        regress_ranges=((-1, 32), (-1, 64), (-1, 128), (-1, 256),
                        (-1, 100000000.0)),
        strides=[8, 16, 32, 64, 128],
        loss_cls=dict(
            type='FocalLoss',
            use_sigmoid=True,
            gamma=2.0,
            alpha=0.25,
            loss_weight=1.0),
        loss_bbox=dict(type='IoULoss', loss_weight=1.0),
        loss_centerness=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        norm_on_bbox=True,
        centerness_on_reg=True))
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.4,
        min_pos_iou=0,
        ignore_iof_thr=-1),
    allowed_border=-1,
    pos_weight=-1,
    debug=False)
test_cfg = dict(
    nms_pre=1000,
    min_bbox_size=0,
    score_thr=0.05,
    nms=dict(type='nms', iou_thr=0.5),
    max_per_img=100)
log_config = dict(interval=60, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
optimizer = dict(
    type='SGD',
    lr=0.001,
    momentum=0.9,
    weight_decay=0.0001,
    paramwise_cfg=dict(bias_lr_mult=2.0, bias_decay_mult=0.0))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='constant',
    warmup_iters=500,
    warmup_ratio=0.3333333333333333,
    step=[45, 48])
total_epochs = 60
checkpoint_config = dict(interval=20)
work_dir = 'logs_nfc_xmax'
gpu_ids = range(0, 1)

/home/zpf/miniconda3/envs/DL/lib/python3.6/site-packages/mmcv/utils/misc.py:304: UserWarning: "out_size" is deprecated in `RoIAlign.__init__`, please use "output_size" instead
  f'"{src_arg_name}" is deprecated in '
/home/zpf/miniconda3/envs/DL/lib/python3.6/site-packages/mmcv/utils/misc.py:304: UserWarning: "sample_num" is deprecated in `RoIAlign.__init__`, please use "sampling_ratio" instead
  f'"{src_arg_name}" is deprecated in '
/home/zpf/miniconda3/envs/DL/lib/python3.6/site-packages/mmcv/utils/misc.py:304: UserWarning: "out_size" is deprecated in `RoIAlign.__init__`, please use "output_size" instead
  f'"{src_arg_name}" is deprecated in '
/home/zpf/miniconda3/envs/DL/lib/python3.6/site-packages/mmcv/utils/misc.py:304: UserWarning: "sample_num" is deprecated in `RoIAlign.__init__`, please use "sampling_ratio" instead
  f'"{src_arg_name}" is deprecated in '
/home/zpf/miniconda3/envs/DL/lib/python3.6/site-packages/mmcv/utils/misc.py:304: UserWarning: "out_size" is deprecated in `RoIAlign.__init__`, please use "output_size" instead
  f'"{src_arg_name}" is deprecated in '
/home/zpf/miniconda3/envs/DL/lib/python3.6/site-packages/mmcv/utils/misc.py:304: UserWarning: "sample_num" is deprecated in `RoIAlign.__init__`, please use "sampling_ratio" instead
  f'"{src_arg_name}" is deprecated in '
2022-02-10 10:17:30,349 - mmdet - INFO - load model from: open-mmlab://detectron2/resnet101_caffe
/home/zpf/miniconda3/envs/DL/lib/python3.6/site-packages/mmcv/utils/misc.py:304: UserWarning: "out_size" is deprecated in `RoIAlign.__init__`, please use "output_size" instead
  f'"{src_arg_name}" is deprecated in '
/home/zpf/miniconda3/envs/DL/lib/python3.6/site-packages/mmcv/utils/misc.py:304: UserWarning: "sample_num" is deprecated in `RoIAlign.__init__`, please use "sampling_ratio" instead
  f'"{src_arg_name}" is deprecated in '
Load repeated weights from the model for layer layer4.0.conv2.weight...
Load repeated weights from the model for layer layer4.0.conv2.weight...
Load repeated weights from the model for layer layer4.0.conv2.weight...
Load repeated weights from the model for layer layer4.0.conv2.weight...
Load repeated weights from the model for layer layer4.1.conv2.weight...
Load repeated weights from the model for layer layer4.1.conv2.weight...
Load repeated weights from the model for layer layer4.1.conv2.weight...
Load repeated weights from the model for layer layer4.1.conv2.weight...
Load repeated weights from the model for layer layer4.2.conv2.weight...
Load repeated weights from the model for layer layer4.2.conv2.weight...
Load repeated weights from the model for layer layer4.2.conv2.weight...
Load repeated weights from the model for layer layer4.2.conv2.weight...
2022-02-10 10:17:32,075 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: layer4.0.conv2.weight, layer4.1.conv2.weight, layer4.2.conv2.weight

missing keys in source state_dict: layer4.0.conv2.attention.fc1.weight, layer4.0.conv2.attention.fc2.weight, layer4.0.conv2.attention.fc2.bias, layer4.0.conv2.deform_attention.fc1.weight, layer4.0.conv2.deform_attention.fc2.weight, layer4.0.conv2.deform_attention.fc2.bias, layer4.0.conv2.conv_offset.weight, layer4.0.conv2.conv_offset.bias, layer4.0.conv2.conv_deform_mask.weight, layer4.0.conv2.conv_deform_mask.bias, layer4.1.conv2.attention.fc1.weight, layer4.1.conv2.attention.fc2.weight, layer4.1.conv2.attention.fc2.bias, layer4.1.conv2.deform_attention.fc1.weight, layer4.1.conv2.deform_attention.fc2.weight, layer4.1.conv2.deform_attention.fc2.bias, layer4.1.conv2.conv_offset.weight, layer4.1.conv2.conv_offset.bias, layer4.1.conv2.conv_deform_mask.weight, layer4.1.conv2.conv_deform_mask.bias, layer4.2.conv2.attention.fc1.weight, layer4.2.conv2.attention.fc2.weight, layer4.2.conv2.attention.fc2.bias, layer4.2.conv2.deform_attention.fc1.weight, layer4.2.conv2.deform_attention.fc2.weight, layer4.2.conv2.deform_attention.fc2.bias, layer4.2.conv2.conv_offset.weight, layer4.2.conv2.conv_offset.bias, layer4.2.conv2.conv_deform_mask.weight, layer4.2.conv2.conv_deform_mask.bias

loading annotations into memory...
loading annotations into memory...
loading annotations into memory...
Done (t=0.17s)
creating index...
Done (t=0.19s)
creating index...
Done (t=0.20s)
creating index...
index created!
index created!
loading annotations into memory...
index created!
Done (t=0.17s)
creating index...
index created!
loading annotations into memory...
loading annotations into memory...
loading annotations into memory...
Done (t=0.05s)
creating index...
loading annotations into memory...
Done (t=0.06s)
creating index...
index created!
index created!
Done (t=0.05s)
creating index...
index created!
2022-02-10 10:17:34,168 - mmdet - INFO - Start running, host: zpf@aa-ESC8000-G4, work_dir: /data2/zpf/mmd_xsf/logs_nfc_xmax
2022-02-10 10:17:34,169 - mmdet - INFO - workflow: [('train', 1)], max: 60 epochs
Done (t=0.05s)
creating index...
index created!
/home/zpf/miniconda3/envs/DL/lib/python3.6/site-packages/torch/nn/functional.py:1639: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/zpf/miniconda3/envs/DL/lib/python3.6/site-packages/torch/nn/functional.py:1639: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/data2/zpf/mmdetection/mmdet/models/dense_heads/fcos_head_rcnn.py:728: UserWarning: This overload of nonzero is deprecated:
	nonzero()
Consider using one of the following signatures instead:
	nonzero(*, bool as_tuple) (Triggered internally at  /opt/conda/conda-bld/pytorch_1603729128610/work/torch/csrc/utils/python_arg_parser.cpp:882.)
  & (flatten_labels < bg_class_ind)).nonzero().reshape(-1)
/data2/zpf/mmdetection/mmdet/models/dense_heads/fcos_head_rcnn.py:728: UserWarning: This overload of nonzero is deprecated:
	nonzero()
Consider using one of the following signatures instead:
	nonzero(*, bool as_tuple) (Triggered internally at  /opt/conda/conda-bld/pytorch_1603729128610/work/torch/csrc/utils/python_arg_parser.cpp:882.)
  & (flatten_labels < bg_class_ind)).nonzero().reshape(-1)
/home/zpf/miniconda3/envs/DL/lib/python3.6/site-packages/torch/nn/functional.py:1639: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/data2/zpf/mmdetection/mmdet/models/dense_heads/fcos_head_rcnn.py:728: UserWarning: This overload of nonzero is deprecated:
	nonzero()
Consider using one of the following signatures instead:
	nonzero(*, bool as_tuple) (Triggered internally at  /opt/conda/conda-bld/pytorch_1603729128610/work/torch/csrc/utils/python_arg_parser.cpp:882.)
  & (flatten_labels < bg_class_ind)).nonzero().reshape(-1)
/home/zpf/miniconda3/envs/DL/lib/python3.6/site-packages/torch/nn/functional.py:1639: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/data2/zpf/mmdetection/mmdet/models/dense_heads/fcos_head_rcnn.py:728: UserWarning: This overload of nonzero is deprecated:
	nonzero()
Consider using one of the following signatures instead:
	nonzero(*, bool as_tuple) (Triggered internally at  /opt/conda/conda-bld/pytorch_1603729128610/work/torch/csrc/utils/python_arg_parser.cpp:882.)
  & (flatten_labels < bg_class_ind)).nonzero().reshape(-1)
2022-02-10 10:18:22,836 - mmdet - INFO - Epoch [1][60/206]	lr: 3.333e-04, eta: 2:46:11, time: 0.811, data_time: 0.166, memory: 5161, loss_cls: 0.9019, loss_bbox: 1.4124, loss_centerness: 0.6183, loss_ada_cls: 0.0100, loss_ada_box: 0.0374, loss: 2.9801, grad_norm: 23.0995
2022-02-10 10:19:00,908 - mmdet - INFO - Epoch [1][120/206]	lr: 3.333e-04, eta: 2:27:25, time: 0.635, data_time: 0.014, memory: 5165, loss_cls: 0.5699, loss_bbox: 0.4655, loss_centerness: 0.5729, loss_ada_cls: 0.1645, loss_ada_box: 0.7427, loss: 2.5155, grad_norm: 14.7363
